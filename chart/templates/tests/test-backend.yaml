---
apiVersion: v1
kind: Pod
metadata:
  annotations:
    "helm.sh/hook": test
  name: '{{ include "acronyms.fullname" . }}-test-backend-connection'
  labels:
    {{- include "acronyms.labels" . | nindent 4 }}
spec:
  containers:
    - name: curl
      args:
        - '{{ include "acronyms.fullname" . }}-backend:{{ .Values.service.port }}/api'
      command:
        - curl
      image: "curlimages/curl:7.82.0"
      livenessProbe:
        exec:
          command:
            - echo live
      readinessProbe:
        exec:
          command:
            - echo ready
      resources:
        {{- toYaml .Values.resources | nindent 8 }}
  restartPolicy: Never

---
apiVersion: v1
kind: Pod
metadata:
  annotations:
    "helm.sh/hook": test
  name: '{{ include "acronyms.fullname" . }}-test-backend-post'
  labels:
    {{- include "acronyms.labels" . | nindent 4 }}
spec:
  containers:
    - name: curl
      args:
        - -X
        - POST
        - --data
        - '{"abbreviation": "ANOVA", "expansion": "Analysis Of Variance"}'
        - --header
        - "Content-Type: application/json"
        - {{ include "acronyms.fullname" . }}-backend:{{ .Values.service.port }}/api
      command:
        - curl
      image: "curlimages/curl:7.82.0"
      livenessProbe:
        exec:
          command:
            - echo live
      readinessProbe:
        exec:
          command:
            - echo ready
      resources:
        {{- toYaml .Values.resources | nindent 8 }}
  restartPolicy: Never
