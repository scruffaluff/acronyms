---
apiVersion: v1
kind: Pod
metadata:
  name: "{{ include "acronyms.fullname" . }}-test-backend-connection"
  annotations:
    "helm.sh/hook": test
  labels:
    {{- include "acronyms.labels" . | nindent 4 }}
spec:
  containers:
    - name: home
      image: "curlimages/curl:7.82.0"
      command: ['curl']
      args: ['{{ include "acronyms.fullname" . }}-backend:{{ .Values.service.port }}/api']
  restartPolicy: Never

---
apiVersion: v1
kind: Pod
metadata:
  name: "{{ include "acronyms.fullname" . }}-test-backend-post"
  annotations:
    "helm.sh/hook": test
  labels:
    {{- include "acronyms.labels" . | nindent 4 }}
spec:
  containers:
    - name: home
      image: "curlimages/curl:7.82.0"
      command: ['curl']
      args:
        - -X
        - POST
        - --data
        - '{"abbreviation": "ANOVA", "expansion": "Analysis Of Variance"}'
        - --header 
        - 'Content-Type: application/json'
        - {{ include "acronyms.fullname" . }}-backend:{{ .Values.service.port }}/api
  restartPolicy: Never
